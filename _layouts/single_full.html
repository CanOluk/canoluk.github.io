---
layout: default
---
{% raw %}{% include base_path %}

<div id="main" role="main">
  <article class="page h-entry page--fullwidth">
    <div class="page__inner-wrap">

      {% if page.title %}
        <header><h1 class="page__title p-name">{{ page.title }}</h1></header>
      {% endif %}

      <!-- BEGIN two-column wrapper -->
      <div class="page__two-col">

        <!-- LEFT: main content -->
        <section class="page__content e-content">
          {{ content }}
        </section>

        <!-- RIGHT: sticky TOC -->
        {% if page.toc %}
        <aside class="sidebar__right{% if page.toc_sticky %} sticky{% endif %}" aria-label="On this page">
          <nav class="toc" id="toc">
            <h4 class="nav__title">{{ page.toc_label | default: "On this page" }}</h4>
            <ul id="toc-list"></ul>
          </nav>
        </aside>
        {% endif %}

      </div>
      <!-- END two-column wrapper -->

      {% if page.share %}{% include social-share.html %}{% endif %}
      {% if site.comments.provider and page.comments %}{% include comments.html %}{% endif %}

    </div>
  </article>
</div>

{% if page.toc %}
<script>
document.addEventListener('DOMContentLoaded', function () {
  const content = document.querySelector('section.page__content');
  const list = document.getElementById('toc-list');
  if (!content || !list) return;

  const headings = content.querySelectorAll('h2, h3'); // add h4 if needed
  if (!headings.length) return;

  const slug = s => s.toLowerCase().trim()
    .replace(/[^\w\s-]/g, '')
    .replace(/\s+/g, '-')
    .replace(/-+/g, '-');

  let lastH2Li = null;

  headings.forEach(h => {
    if (!h.id) h.id = slug(h.textContent);

    const a = document.createElement('a');
    a.href = '#' + h.id;
    a.textContent = h.textContent;

    if (h.tagName === 'H2') {
      const li = document.createElement('li');
      li.className = 'toc-h2';
      li.appendChild(a);
      list.appendChild(li);
      lastH2Li = li;
    } else {
      // H3
      if (!lastH2Li) return; // guard if H3 appears before any H2
      let sub = lastH2Li.querySelector('ul');
      if (!sub) {
        sub = document.createElement('ul');
        sub.className = 'toc-sub';
        lastH2Li.appendChild(sub);
      }
      const subLi = document.createElement('li');
      subLi.appendChild(a);
      sub.appendChild(subLi);
    }
  });
});
</script>
{% endif %}{% endraw %}
